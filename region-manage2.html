<!DOCTYPE HTML>
<html>

	<head>
		<meta charset="utf-8">
		<meta name="renderer" content="webkit|ie-comp|ie-stand">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
		<meta http-equiv="Cache-Control" content="no-siteapp" />
		<!--[if lt IE 9]>
<script type="text/javascript" src="lib/html5shiv.js"></script>
<script type="text/javascript" src="lib/respond.min.js"></script>
<![endif]-->
		<link rel="stylesheet" type="text/css" href="static/h-ui/css/H-ui.min.css" />
		<link rel="stylesheet" type="text/css" href="static/h-ui.admin/css/H-ui.admin.css" />
		<link rel="stylesheet" type="text/css" href="lib/Hui-iconfont/1.0.8/iconfont.css" />
		<link rel="stylesheet" type="text/css" href="static/h-ui.admin/skin/default/skin.css" id="skin" />
		<link rel="stylesheet" type="text/css" href="static/h-ui.admin/css/style.css" />
		<!--[if IE 6]>
<script type="text/javascript" src="lib/DD_belatedPNG_0.0.8a-min.js" ></script>
<script>DD_belatedPNG.fix('*');</script>
<![endif]-->
		<title>赤峰市森林公安网上办公系统</title>
		<link rel="Bookmark" href="favicon.ico">
		<link rel="Shortcut Icon" href="favicon.ico" />
		<link rel="stylesheet" href="lib/zTree/v3/css/zTreeStyle/zTreeStyle.css" type="text/css">
		<style type="text/css">
			.ztree li span.button.add {
				margin-left: 2px;
				margin-right: -1px;
				background-position: -144px 0;
				vertical-align: top;
				*vertical-align: middle
			}
		</style>
	</head>

	<body class="pos-r">
		<div class="pos-a" style="width:200px;left:0;top:0; bottom:0; height:100%; border-right:1px solid #e5e5e5; background-color:#f5f5f5; overflow:auto; text-align: center;">
			<!--<a id="regionAddBtn" style="text-decoration:none" class="ml-5" href="javascript:;" title="增加"><span class="label label-success radius">增加</span></a>
			<a id="regionEditBtn" style="text-decoration:none" class="ml-5" href="javascript:;" title="修改"><span class="label label-success radius">修改</span></a>
			<a id="regionDelBtn" style="text-decoration:none" class="ml-5" onClick="product_del(this,'10001')" href="javascript:;" title="删除"><span class="label label-success radius">删除</span></a>-->
			<ul id="treeDemo" class="ztree"></ul>
		</div>
		<div style="margin-left:200px;">
			<nav class="breadcrumb"><i class="Hui-iconfont">&#xe67f;</i> 首页 <span class="c-gray en">&gt;</span> 账号权限管理 <span class="c-gray en">&gt;</span> 区域管理
				<a class="btn btn-success radius r" style="line-height:1.6em;margin-top:3px" href="javascript:location.replace(location.href);" title="刷新"><i class="Hui-iconfont">&#xe68f;</i></a>
			</nav>
			<div class="page-container">
				<!--<div class="text-c">
					<input type="text" name="" id="" placeholder=" 请输入查询内容...	" style="width:250px" class="input-text">
					<button name="" id="" class="btn btn-success" type="submit"><i class="Hui-iconfont">&#xe665;</i> 查询</button>
				</div>-->
				<div class="cl pd-5 bg-1 bk-gray mt-20">
					<span class="l">
						<a class="btn btn-primary radius" onclick="product_add('添加','region-manage-add.html')" href="javascript:;">
							<i class="Hui-iconfont">&#xe600;</i> 添加</a></span> <span class="r">共有数据：<strong>54</strong> 条</span> </div>
				<div class="mt-20">
					<table class="table table-border table-bordered table-bg table-hover">
						<thead>
							<tr class="text-c">
								<th width="40">ID</th>
								<th width="100">职位名称</th>
								<th width="60">状态</th>
								<th width="140">操作</th>
							</tr>
						</thead>
						<tbody>
							<tr class="text-c va-m">
								<td>001</td>
								<td>普通职员</td>
								<td class="td-status">
									<span class="label label-success radius">在职</span>
								</td>
								<td class="td-manage">
									<a style="text-decoration:none" class="ml-5" onClick="product_edit('编辑','region-manage-add.html','10001')" href="javascript:;" title="编辑"><i class="Hui-iconfont">&#xe6df;</i></a>
									<a style="text-decoration:none" class="ml-5" onClick="product_del(this,'10001')" href="javascript:;" title="删除"><i class="Hui-iconfont">&#xe6e2;</i></a>
									<a style="text-decoration:none" class="ml-5" onClick="product_edit('编辑','region-manage-power.html','10001')" href="javascript:;" title="分配权限"><span class="label label-success radius">分配权限</span></a>
								</td>
							</tr>
						</tbody>
					</table>
				</div>
			</div>
		</div>

		<div id="addmodal-demo" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
			<div class="modal-dialog">
				<div class="modal-content radius">
					<div class="modal-header">
						<h3 class="modal-title">追加部门</h3>
						<a class="close" data-dismiss="modal" aria-hidden="true" href="javascript:void();">×</a>
					</div>
					<div class="modal-body">
						请输入要追加的部门名称:
						<input type="text" id="editNewName" placeholder=" 请输入内容...	" style="width:250px" class="input-text">
					</div>
					<div class="modal-footer">
						<button id="saveEditNewName" class="btn btn-primary">保存</button>
						<button class="btn" data-dismiss="modal" aria-hidden="true">关闭</button>
					</div>
				</div>
			</div>
		</div>
		<div id="editmodal-demo" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
			<div class="modal-dialog">
				<div class="modal-content radius">
					<div class="modal-header">
						<h3 class="modal-title">对机构或部门名称的修改</h3>
						<a class="close" data-dismiss="modal" aria-hidden="true" href="javascript:void();">×</a>
					</div>
					<div class="modal-body">
						当前名称为:<span style="color: red;">政治处</span> 修改为:
						<input type="text" id="editNewName" placeholder=" 请输入修改内容...	" style="width:250px" class="input-text">
					</div>
					<div class="modal-footer">
						<button id="saveEditNewName" class="btn btn-primary">保存</button>
						<button class="btn" data-dismiss="modal" aria-hidden="true">关闭</button>
					</div>
				</div>
			</div>
		</div>
		<script type="text/javascript" src="lib/jquery/1.9.1/jquery.min.js"></script>
		<script type="text/javascript" src="lib/layer/2.4/layer.js"></script>
		<script type="text/javascript" src="static/h-ui/js/H-ui.min.js"></script>
		<script type="text/javascript" src="static/h-ui.admin/js/H-ui.admin.js"></script>

		<!--请在下方写此页面业务相关的脚本-->
		<script type="text/javascript" src="lib/zTree/v3/js/jquery.ztree.all-3.5.min.js"></script>
		<script type="text/javascript" src="lib/My97DatePicker/4.8/WdatePicker.js"></script>
		<script type="text/javascript" src="lib/datatables/1.10.0/jquery.dataTables.min.js"></script>
		<script type="text/javascript" src="lib/laypage/1.2/laypage.js"></script>
		<script type="text/javascript">
			/*var setting = {
							view: {
								dblClickExpand: false,
								showLine: false,
								selectedMulti: false
							},
							data: {
								simpleData: {
									enable: true,
									idKey: "id",
									pIdKey: "pId",
									rootPId: ""
								}
							},
							callback: {
								beforeClick: function(treeId, treeNode) {
									var zTree = $.fn.zTree.getZTreeObj("tree");
									if(treeNode.isParent) {
										zTree.expandNode(treeNode);
										return false;
									} else {
										//demoIframe.attr("src",treeNode.file + ".html");
										return true;
									}
								}
							}
						};

						var zNodes = [{
								id: 1,
								pId: 0,
								name: "各地区及部门管理",
								open: true
							},
							{
								id: 11,
								pId: 1,
								name: "赤峰市公安局"
							},
							{
								id: 111,
								pId: 11,
								name: "政治处"
							},
							{
								id: 112,
								pId: 11,
								name: "财务科"
							},
							{
								id: 113,
								pId: 11,
								name: "法制科"
							},
							{
								id: 114,
								pId: 11,
								name: "户政科"
							},
							{
								id: 12,
								pId: 1,
								name: "赤峰市公安局2"
							},
							{
								id: 121,
								pId: 12,
								name: "刑侦"
							},
							{
								id: 122,
								pId: 12,
								name: "治安"
							},
							{
								id: 123,
								pId: 12,
								name: "户政"
							}
						];

						$(document).ready(function() {
							var t = $("#treeDemo");
							t = $.fn.zTree.init(t, setting, zNodes);
							//demoIframe = $("#testIframe");
							//demoIframe.on("load", loadReady);
							var zTree = $.fn.zTree.getZTreeObj("tree");
							//zTree.selectNode(zTree.getNodeByParam("id",'11'));
						});*/

			$('.table-sort').dataTable({
				"aaSorting": [
					[1, "desc"]
				], //默认第几个排序
				"bStateSave": true, //状态保存
				"aoColumnDefs": [{
						"orderable": false,
						"aTargets": [0, 7]
					} // 制定列不参与排序
				]
			});
			/*产品-添加*/
			function product_add(title, url) {
				var index = layer.open({
					type: 2,
					title: title,
					content: url
				});
				layer.full(index);
			}
			/*产品-查看*/
			function product_show(title, url, id) {
				var index = layer.open({
					type: 2,
					title: title,
					content: url
				});
				layer.full(index);
			}

			/*产品-编辑*/
			function product_edit(title, url, id) {
				var index = layer.open({
					type: 2,
					title: title,
					content: url
				});
				layer.full(index);
			}

			/*产品-删除*/
			function product_del(obj, id) {
				layer.confirm('确认要删除吗？', function(index) {
					$.ajax({
						type: 'POST',
						url: '',
						dataType: 'json',
						success: function(data) {
							$(obj).parents("tr").remove();
							layer.msg('已删除!', {
								icon: 1,
								time: 1000
							});
						},
						error: function(data) {
							console.log(data.msg);
						},
					});
				});
			};

			//屏蔽浏览器右键菜单  
			/*document.oncontextmenu = function() {
				return false;
			};*/

			$('#regionAddBtn').children().click(function() {

				$("#addmodal-demo").modal("show");
			});

			$('#regionEditBtn span').click(function() {
				$("#editmodal-demo").modal("show");
			});

			var setting = {
				view: {
					addHoverDom: addHoverDom,
					removeHoverDom: removeHoverDom,
					selectedMulti: false
				},
				edit: {
					enable: true,
					editNameSelectAll: true,
					showRemoveBtn: showRemoveBtn,
					showRenameBtn: showRenameBtn
				},
				data: {
					simpleData: {
						enable: true
					}
				},
				callback: {
					beforeDrag: beforeDrag,
					beforeEditName: beforeEditName,
					beforeRemove: beforeRemove,
					beforeRename: beforeRename,
					onRemove: onRemove,
					onRename: onRename
				}
			};

			var zNodes = [{
					id: 1,
					pId: 0,
					name: "各地区及部门管理",
					open: true
				},
				{
					id: 11,
					pId: 1,
					name: "赤峰市公安局"
				},
				{
					id: 111,
					pId: 11,
					name: "政治处"
				},
				{
					id: 112,
					pId: 11,
					name: "财务科"
				},
				{
					id: 113,
					pId: 11,
					name: "法制科"
				},
				{
					id: 114,
					pId: 11,
					name: "户政科"
				},
				{
					id: 12,
					pId: 1,
					name: "赤峰市公安局2"
				},
				{
					id: 121,
					pId: 12,
					name: "刑侦"
				},
				{
					id: 122,
					pId: 12,
					name: "治安"
				},
				{
					id: 123,
					pId: 12,
					name: "户政"
				}
			];
			var log, className = "dark";

			function beforeDrag(treeId, treeNodes) {
				return false;
			}

			function beforeEditName(treeId, treeNode) {
				className = (className === "dark" ? "" : "dark");
				showLog("[ " + getTime() + " beforeEditName ]&nbsp;&nbsp;&nbsp;&nbsp; " + treeNode.name);
				var zTree = $.fn.zTree.getZTreeObj("treeDemo");
				zTree.selectNode(treeNode);
				setTimeout(function() {
					//if(confirm("进入节点 -- " + treeNode.name + " 的编辑状态吗？")) {
						setTimeout(function() {
							zTree.editName(treeNode);
						}, 0);
					//}
				}, 0);
				return false;
			}

			function beforeRemove(treeId, treeNode) {
				className = (className === "dark" ? "" : "dark");
				showLog("[ " + getTime() + " beforeRemove ]&nbsp;&nbsp;&nbsp;&nbsp; " + treeNode.name);
				var zTree = $.fn.zTree.getZTreeObj("treeDemo");
				zTree.selectNode(treeNode);
				return confirm("确认删除 节点 -- " + treeNode.name + " 吗？");
			}

			function onRemove(e, treeId, treeNode) {
				showLog("[ " + getTime() + " onRemove ]&nbsp;&nbsp;&nbsp;&nbsp; " + treeNode.name);
			}

			function beforeRename(treeId, treeNode, newName, isCancel) {
				className = (className === "dark" ? "" : "dark");
				showLog((isCancel ? "<span style='color:red'>" : "") + "[ " + getTime() + " beforeRename ]&nbsp;&nbsp;&nbsp;&nbsp; " + treeNode.name + (isCancel ? "</span>" : ""));
				if(newName.length == 0) {
					setTimeout(function() {
						var zTree = $.fn.zTree.getZTreeObj("treeDemo");
						zTree.cancelEditName();
						alert("节点名称不能为空.");
					}, 0);
					return false;
				}
				return true;
			}

			function onRename(e, treeId, treeNode, isCancel) {
				showLog((isCancel ? "<span style='color:red'>" : "") + "[ " + getTime() + " onRename ]&nbsp;&nbsp;&nbsp;&nbsp; " + treeNode.name + (isCancel ? "</span>" : ""));
			}

			function showRemoveBtn(treeId, treeNode) {
				return !treeNode.isFirstNode;
			}

			function showRenameBtn(treeId, treeNode) {
				return !treeNode.isLastNode;
			}

			function showLog(str) {
				if(!log) log = $("#log");
				log.append("<li class='" + className + "'>" + str + "</li>");
				if(log.children("li").length > 8) {
					log.get(0).removeChild(log.children("li")[0]);
				}
			}

			function getTime() {
				var now = new Date(),
					h = now.getHours(),
					m = now.getMinutes(),
					s = now.getSeconds(),
					ms = now.getMilliseconds();
				return(h + ":" + m + ":" + s + " " + ms);
			}

			var newCount = 1;

			function addHoverDom(treeId, treeNode) {
				console.log(treeNode.tId);
				console.log(treeNode.editNameFlag);
				var sObj = $("#" + treeNode.tId + "_span");
				if(treeNode.editNameFlag || $("#addBtn_" + treeNode.tId).length > 0) return;
				var addStr = "<span class='button add' id='addBtn_" + treeNode.tId +
					"' title='add node' onfocus='this.blur();'></span>";
				sObj.after(addStr);
				var btn = $("#addBtn_" + treeNode.tId);
				if(btn) btn.bind("click", function() {
					var zTree = $.fn.zTree.getZTreeObj("treeDemo");
					zTree.addNodes(treeNode, {
						id: (100 + newCount),
						pId: treeNode.id,
						name: "new node" + (newCount++)
					});
					return false;
				});
			};

			function removeHoverDom(treeId, treeNode) {
				$("#addBtn_" + treeNode.tId).unbind().remove();
			};

			function selectAll() {
				var zTree = $.fn.zTree.getZTreeObj("treeDemo");
				zTree.setting.edit.editNameSelectAll = $("#selectAll").attr("checked");
			}

			$(document).ready(function() {
				$.fn.zTree.init($("#treeDemo"), setting, zNodes);
				$("#selectAll").bind("click", selectAll);
			});
		</script>
	</body>

</html>